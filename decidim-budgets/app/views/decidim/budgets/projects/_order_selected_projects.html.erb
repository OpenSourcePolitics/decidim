<div id="order-selected-projects">
  <div class="card__content budget-summary__selected">
    <h3 class="heading3"><%= t(".title") %></h3>
    <% if current_order_projects_count.positive? %>
      <ul class="budget-summary__selected-list">
        <% current_order.projects.each do |project| %>
          <li class="budget-summary__selected-item">
            <%= link_to translated_attribute(project.title), project %>
            <strong class="budget-summary__selected-number">
              <%= budget_to_currency project.budget %>
            </strong>
            <%= remove_project_trash_icon_button(project) unless current_order_checked_out? %>
          </li>
        <% end %>
      </ul>
    <% end %>
    <% unless current_order_checked_out? %>
      <ul class="budget-summary__list">
        <% if component_settings.vote_per_project? %>
          <li><%= t(".selected_total", count: current_order_projects_count, total: component_settings.total_projects).html_safe %></li>
        <% end %>
        <% if component_settings.vote_per_category? %>
          <% categories = current_participatory_space.categories.first_class %>
          <% projects_per_category_treshold.each do |id, total| %>
            <% category = categories.find_by(id: id)&.translated_name %>
            <% count = current_order ? current_order.projects_per_category.fetch(id, 0) : 0 %>
            <li><%= t(".selected_per_category", count: count, total: total, category: category).html_safe %></li>
          <% end %>
        <% end %>
        <button class="button small button--sc" data-toggle="budget-confirm" <%= vote_button_disabled? %>><%= t(".vote") %></button>
      </ul>
    <% end %>
  </div>
<% else %>
  <div id="order-selected-projects">
    <% if current_order&.projects&.any? %>
      <div class="card__content budget-summary__selected">
        <button data-toggle="reveal-selected">
          <strong><%= current_order.projects.size %> </strong><%= t(".selected_projects", count: current_order.projects.size) %>
          <%= icon("caret-bottom", class: "icon--small", aria_label: t(".view"), role: "img") %>
        </button>
        <div id="reveal-selected" class="hide" data-toggler=".hide">
          <ul class="budget-summary__selected-list">
            <% current_order.projects.each do |project| %>
              <li class="budget-summary__selected-item">
                <%= link_to translated_attribute(project.title), project %>
                <strong class="budget-summary__selected-number">
                  <%= budget_to_currency project.budget %>
                </strong>
                <% unless current_order_checked_out? %>
                  <%= button_to order_line_item_path(project_id: project), method: :delete, remote: true, data: { disable: true }, form: { style: "display: inline" } do %>
                    <%= icon("trash", aria_label: t(".remove"), role: "img") %>
                  <% end %>
                <% end %>
              </li>
            <% end %>
          </ul>
        </div>
      </div>
    <% end %>
  </div>
</div>
